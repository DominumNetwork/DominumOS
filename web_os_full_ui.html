<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WebOS</title>
  <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', 'Inter', sans-serif;
    }
    body, html {
      height: 100%;
      background: #1a1a1a;
      overflow: hidden;
    }
    #wallpaper {
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      z-index: 0;
      background: linear-gradient(120deg, #3a6ee8 0%, #6e9ee8 100%);
      background-image: url('https://wallpapercave.com/wp/wp9737476.jpg');
      background-size: cover;
      background-position: center;
      filter: brightness(0.95) blur(0.5px);
    }
    #desktop {
      width: 100vw;
      height: calc(100vh - 48px);
      position: relative;
      z-index: 1;
    }
    .window {
      width: 420px;
      height: 320px;
      background: rgba(255,255,255,0.95);
      position: absolute;
      top: 80px;
      left: 80px;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.18);
      transition: box-shadow 0.2s;
      display: flex;
      flex-direction: column;
      border: 1.5px solid #e0e0e0;
      min-width: 280px;
      min-height: 120px;
      resize: both;
      overflow: hidden;
      z-index: 10;
      animation: fadein 0.2s;
    }
    @keyframes fadein {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    .window.active {
      box-shadow: 0 12px 40px 0 #2563eb44, 0 2px 8px #0002;
      border: 2px solid #2563eb;
    }
    .title-bar {
      background: rgba(245,245,245,0.95);
      color: #222;
      padding: 0 12px;
      height: 38px;
      display: flex;
      align-items: center;
      border-radius: 12px 12px 0 0;
      cursor: move;
      user-select: none;
      font-weight: 600;
      font-size: 1.05em;
      border-bottom: 1px solid #e0e0e0;
      justify-content: space-between;
    }
    .window-controls {
      display: flex;
      gap: 6px;
    }
    .window-controls button {
      width: 28px; height: 28px;
      border: none;
      background: none;
      border-radius: 6px;
      margin-left: 2px;
      font-size: 1.1em;
      cursor: pointer;
      transition: background 0.15s;
    }
    .window-controls button:hover {
      background: #e0e0e0;
    }
    .window-controls .close:hover {
      background: #e81123;
      color: #fff;
    }
    .content {
      flex: 1;
      padding: 16px;
      overflow: auto;
      font-size: 1em;
      color: #222;
    }
    #context-menu {
      position: absolute;
      background: #232323ee;
      color: white;
      border-radius: 8px;
      padding: 8px 0;
      display: none;
      z-index: 9999;
      min-width: 180px;
      box-shadow: 0 4px 16px #0005;
      font-size: 1em;
    }
    #context-menu ul {
      list-style: none;
    }
    #context-menu ul li {
      padding: 8px 20px;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.15s;
    }
    #context-menu ul li:hover {
      background: #2563eb;
    }
    #taskbar {
      height: 48px;
      background: rgba(245,245,245,0.95);
      display: flex;
      align-items: center;
      justify-content: space-between;
      color: #222;
      padding: 0 18px;
      position: fixed;
      bottom: 0;
      width: 100vw;
      z-index: 10000;
      box-shadow: 0 -2px 12px #0002;
      border-top: 1px solid #e0e0e0;
    }
    #taskbar .left, #taskbar .right {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    #start-menu {
      position: absolute;
      bottom: 60px;
      left: 24px;
      background: rgba(255,255,255,0.98);
      color: #222;
      border-radius: 18px;
      padding: 18px 24px 18px 24px;
      display: none;
      z-index: 9999;
      min-width: 320px;
      box-shadow: 0 8px 32px #0003;
      font-size: 1.1em;
    }
    #start-menu h3 {
      margin-bottom: 12px;
      font-weight: 600;
      font-size: 1.15em;
    }
    #start-menu .app-list div {
      padding: 8px 0;
      cursor: pointer;
      border-radius: 6px;
      transition: background 0.15s;
      padding-left: 8px;
    }
    #start-menu .app-list div:hover {
      background: #e0e7ef;
    }
    .desktop-icon {
      width: 68px;
      text-align: center;
      color: white;
      position: absolute;
      cursor: pointer;
      z-index: 2;
      filter: drop-shadow(0 2px 8px #0005);
      transition: transform 0.1s;
    }
    .desktop-icon img {
      width: 44px;
      height: 44px;
      border-radius: 8px;
      margin-bottom: 4px;
      background: #fff8;
    }
    .desktop-icon:active {
      transform: scale(0.97);
    }
    /* Battery and WiFi SVGs */
    .svg-icon {
      width: 28px;
      height: 28px;
      display: inline-block;
      vertical-align: middle;
    }
    /* Animations for battery/wifi */
    .battery-fill {
      transition: width 0.7s cubic-bezier(.4,2,.6,1);
    }
    .wifi-wave {
      opacity: 0.7;
      animation: wifiPulse 2s infinite;
    }
    @keyframes wifiPulse {
      0% { opacity: 0.7; }
      50% { opacity: 1; }
      100% { opacity: 0.7; }
    }
  </style>
</head>
<body>
  <div id="wallpaper"></div>
  <div id="desktop"></div>

  <div id="start-menu">
    <h3>Start</h3>
    <div class="app-list">
      <div onclick="launchApp('Terminal')">Terminal</div>
      <div onclick="launchApp('File Explorer')">File Explorer</div>
      <div onclick="launchApp('Browser')">Browser</div>
      <div onclick="launchApp('Settings')">Settings</div>
      <div onclick="launchApp('Notepad')">Notepad</div>
      <div onclick="launchApp('Calculator')">Calculator</div>
    </div>
  </div>

  <div id="taskbar">
    <div class="left">
      <button id="start-btn" style="background:none;border:none;font-size:1.5em;cursor:pointer;border-radius:8px;padding:4px 10px;transition:background 0.15s;">
        <img src="https://upload.wikimedia.org/wikipedia/commons/4/48/Windows_logo_-_2021.svg" style="width:28px;height:28px;vertical-align:middle;"/>
      </button>
      <div id="taskbar-apps"></div>
    </div>
    <div class="right">
      <span id="time-display"></span>
      <span id="wifi-svg" class="svg-icon"></span>
      <span id="battery-svg" class="svg-icon"></span>
    </div>
  </div>

  <div id="context-menu">
    <ul>
      <li onclick="launchApp('Terminal')">Open Terminal</li>
      <li onclick="launchApp('File Explorer')">Open File Explorer</li>
      <li onclick="launchApp('Browser')">Open Browser</li>
      <li onclick="launchApp('Notepad')">Open Notepad</li>
      <li onclick="launchApp('Calculator')">Open Calculator</li>
      <li onclick="launchApp('Settings')">Open Settings</li>
    </ul>
  </div>

  <script>
    // --- Desktop and Window System ---
    const desktop = document.getElementById('desktop');
    const contextMenu = document.getElementById('context-menu');
    const startMenu = document.getElementById('start-menu');
    const startBtn = document.getElementById('start-btn');
    const taskbarApps = document.getElementById('taskbar-apps');
    const timeDisplay = document.getElementById('time-display');
    let zIndexCounter = 20;
    let openWindows = [];

    // --- Context Menu ---
    desktop.addEventListener('contextmenu', e => {
      e.preventDefault();
      contextMenu.style.left = `${e.pageX}px`;
      contextMenu.style.top = `${e.pageY}px`;
      contextMenu.style.display = 'block';
    });
    window.addEventListener('click', e => {
      if (!contextMenu.contains(e.target)) contextMenu.style.display = 'none';
      if (!startMenu.contains(e.target) && e.target !== startBtn) startMenu.style.display = 'none';
    });

    // --- Start Menu ---
    startBtn.onclick = e => {
      e.stopPropagation();
      startMenu.style.display = startMenu.style.display === 'block' ? 'none' : 'block';
    };

    // --- Window Management ---
    function launchApp(title) {
      // If app is already open and not multi-instance, focus it
      let win = openWindows.find(w => w.dataset.appTitle === title);
      if (win && !['Notepad'].includes(title)) {
        focusWindow(win);
        return;
      }
      win = document.createElement('div');
      win.className = 'window';
      win.dataset.appTitle = title;
      win.style.zIndex = zIndexCounter++;
      win.innerHTML = `
        <div class="title-bar">
          <span>${title}</span>
          <span class="window-controls">
            <button class="minimize" title="Minimize">&#x2015;</button>
            <button class="maximize" title="Maximize">&#x25A1;</button>
            <button class="close" title="Close">&#x2715;</button>
          </span>
        </div>
        <div class="content">${getAppContent(title)}</div>
      `;
      desktop.appendChild(win);
      makeDraggable(win);
      win.addEventListener('mousedown', () => focusWindow(win));
      focusWindow(win);
      openWindows.push(win);
      updateTaskbar();
      // Window controls
      const [minBtn, maxBtn, closeBtn] = win.querySelectorAll('.window-controls button');
      minBtn.onclick = e => {
        e.stopPropagation();
        win.style.display = 'none';
        updateTaskbar();
      };
      maxBtn.onclick = e => {
        e.stopPropagation();
        if (win.classList.contains('maximized')) {
          win.classList.remove('maximized');
          win.style.top = win.dataset.prevTop;
          win.style.left = win.dataset.prevLeft;
          win.style.width = win.dataset.prevWidth;
          win.style.height = win.dataset.prevHeight;
        } else {
          win.dataset.prevTop = win.style.top;
          win.dataset.prevLeft = win.style.left;
          win.dataset.prevWidth = win.style.width;
          win.dataset.prevHeight = win.style.height;
          win.classList.add('maximized');
          win.style.top = '0';
          win.style.left = '0';
          win.style.width = '100vw';
          win.style.height = 'calc(100vh - 48px)';
        }
      };
      closeBtn.onclick = e => {
        e.stopPropagation();
        win.remove();
        openWindows = openWindows.filter(w => w !== win);
        updateTaskbar();
      };
    }

    function focusWindow(win) {
      openWindows.forEach(w => w.classList.remove('active'));
      win.classList.add('active');
      win.style.zIndex = zIndexCounter++;
    }

    function updateTaskbar() {
      taskbarApps.innerHTML = '';
      openWindows.forEach(win => {
        const btn = document.createElement('button');
        btn.textContent = win.dataset.appTitle;
        btn.style = 'background:none;border:none;padding:6px 14px;margin:0 2px;border-radius:8px;cursor:pointer;font-weight:500;font-size:1em;transition:background 0.15s;';
        if (win.style.display !== 'none') btn.style.background = '#e0e7ef';
        btn.onclick = e => {
          e.stopPropagation();
          if (win.style.display === 'none') win.style.display = '';
          focusWindow(win);
        };
        taskbarApps.appendChild(btn);
      });
    }

    function makeDraggable(win) {
      const titleBar = win.querySelector('.title-bar');
      let isDragging = false, offsetX, offsetY;
      titleBar.addEventListener('mousedown', e => {
        if (e.target.closest('.window-controls')) return;
        isDragging = true;
        offsetX = e.clientX - win.offsetLeft;
        offsetY = e.clientY - win.offsetTop;
        focusWindow(win);
      });
      document.addEventListener('mousemove', e => {
        if (isDragging && !win.classList.contains('maximized')) {
          win.style.left = `${e.clientX - offsetX}px`;
          win.style.top = `${e.clientY - offsetY}px`;
        }
      });
      document.addEventListener('mouseup', () => {
        isDragging = false;
      });
    }

    function createDesktopIcon(title, x, y, iconUrl) {
      const icon = document.createElement('div');
      icon.className = 'desktop-icon';
      icon.style.left = `${x}px`;
      icon.style.top = `${y}px`;
      icon.innerHTML = `<img src="${iconUrl}" /><div>${title}</div>`;
      icon.addEventListener('dblclick', () => launchApp(title));
      desktop.appendChild(icon);
    }

    // --- Desktop Icons ---
    const appIcons = {
      'Terminal': 'https://img.icons8.com/fluency/48/000000/console.png',
      'File Explorer': 'https://img.icons8.com/fluency/48/000000/folder-invoices.png',
      'Browser': 'https://img.icons8.com/fluency/48/000000/internet-browser.png',
      'Settings': 'https://img.icons8.com/fluency/48/000000/settings.png',
      'Notepad': 'https://img.icons8.com/fluency/48/000000/notepad.png',
      'Calculator': 'https://img.icons8.com/fluency/48/000000/calculator.png',
    };
    let iconY = 32;
    Object.entries(appIcons).forEach(([app, url], i) => {
      createDesktopIcon(app, 32, iconY, url);
      iconY += 84;
    });

    // --- App Content ---
    function getAppContent(title) {
      switch (title) {
        case 'Terminal':
          return `<div style='font-family:monospace;font-size:1em;background:#181818;color:#0f0;padding:8px;border-radius:6px;height:100%;'>webOS@user:~$ <span id='term-cursor'>█</span></div>`;
        case 'File Explorer':
          return `<div><b>Files:</b><ul><li>Documents</li><li>Pictures</li><li>Music</li><li>Videos</li></ul></div>`;
        case 'Browser':
          return `<iframe src='https://bing.com' style='width:100%;height:90%;border:none;border-radius:8px;'></iframe>`;
        case 'Settings':
          return `<div><b>Settings</b><br><br><label>Theme: <select><option>Light</option><option>Dark</option></select></label></div>`;
        case 'Notepad':
          return `<textarea style='width:100%;height:90%;resize:none;font-size:1em;border-radius:8px;padding:8px;border:1px solid #e0e0e0;'></textarea>`;
        case 'Calculator':
          return `<div id='calc-app'><input id='calc-display' style='width:100%;font-size:1.2em;margin-bottom:8px;padding:6px;border-radius:6px;border:1px solid #e0e0e0;text-align:right;' readonly /><div style='display:grid;grid-template-columns:repeat(4,1fr);gap:6px;'>${[7,8,9,'/','4',5,6,'*','1',2,3,'-','0','.','=','+'].map(b=>`<button onclick=calcPress('${b}') style='padding:12px;font-size:1.1em;border-radius:6px;border:none;background:#e0e7ef;cursor:pointer;'>${b}</button>`).join('')}</div></div>`;
        default:
          return `This is the ${title} app.`;
      }
    }

    // --- Calculator Logic ---
    window.calcPress = function(val) {
      const disp = document.getElementById('calc-display');
      if (!disp) return;
      if (val === '=') {
        try { disp.value = eval(disp.value); } catch { disp.value = 'Error'; }
      } else if (val === 'C') {
        disp.value = '';
      } else {
        disp.value += val;
      }
    }

    // --- Time ---
    function updateTime() {
      const now = new Date();
      timeDisplay.textContent = now.toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});
    }
    setInterval(updateTime, 1000);
    updateTime();

    // --- Battery SVG ---
    function renderBattery(level = 0.7, charging = false) {
      const color = level > 0.5 ? '#4ade80' : level > 0.2 ? '#facc15' : '#ef4444';
      document.getElementById('battery-svg').innerHTML = `
        <svg viewBox="0 0 36 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="1" y="4" width="30" height="12" rx="4" fill="#e5e7eb" stroke="#222" stroke-width="1.5"/>
          <rect x="33" y="8" width="2" height="4" rx="1" fill="#222"/>
          <rect class="battery-fill" x="3" y="6" width="${26*level}" height="8" rx="3" fill="${color}"/>
          ${charging ? '<polygon points="16,7 20,7 18,13 22,13 14,19 16,13 12,13" fill="#2563eb"/>' : ''}
        </svg>
      `;
    }
    // Animate battery
    let batteryLevel = 0.7, batteryDir = -0.01;
    setInterval(() => {
      batteryLevel += batteryDir * (Math.random()*0.03+0.01);
      if (batteryLevel < 0.15 || batteryLevel > 0.95) batteryDir *= -1;
      renderBattery(batteryLevel, batteryLevel > 0.95);
    }, 1200);
    renderBattery();

    // --- WiFi SVG ---
    function renderWifi(strength = 3) {
      document.getElementById('wifi-svg').innerHTML = `
        <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="16" cy="25" r="2.5" fill="#2563eb"/>
          <path class="wifi-wave" d="M8 19c4-4 12-4 16 0" stroke="#2563eb" stroke-width="2.5" fill="none"/>
          <path class="wifi-wave" d="M4 15c6-6 18-6 24 0" stroke="#2563eb" stroke-width="2" fill="none"/>
          <path class="wifi-wave" d="M12 23c2-2 6-2 8 0" stroke="#2563eb" stroke-width="2.5" fill="none"/>
        </svg>
      `;
    }
    setInterval(() => renderWifi(Math.floor(Math.random()*4)), 2000);
    renderWifi();
  </script>
</body>
</html>
